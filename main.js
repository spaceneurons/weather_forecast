!function(){"use strict";var t={};function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var n,o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._keyWeather="14926d4323273168c22be818f4f8b491",this._mainUrl="https://api.openweathermap.org/data/2.5/weather?",this._keyPhoto="19932890-3440ea8c759315d97a3ef428e",this._photoUrl="https://pixabay.com/api/?key="}var n,o;return n=t,(o=[{key:"getLocation",value:function(){return fetch("https://ipapi.co/json/").then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getWeather",value:function(t,e){return fetch("".concat(this._mainUrl,"lat=").concat(t,"&lon=").concat(e,"&units=metric&appid=").concat(this._keyWeather,"&lang=ru")).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getAnotherWeather",value:function(t){return fetch("".concat(this._mainUrl,"q=").concat(t,"&units=metric&appid=").concat(this._keyWeather,"&lang=ru")).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getPhoto",value:function(t){var e=t.name,n=t.weather;return fetch("".concat(this._photoUrl).concat(this._keyPhoto,"&q=").concat(e,"+city+").concat(n[0].main,"&lang=ru&image_type=photo&orientation=horizontal&category=places")).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getOtherPhoto",value:function(t){return fetch("".concat(this._photoUrl).concat(this._keyPhoto,"&q=").concat(t,"+weather&lang=ru&image_type=photo&orientation=horizontal&category=backgrounds")).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}},{key:"getPhotoOnlyCity",value:function(t){var e=t.name;return fetch("".concat(this._photoUrl).concat(this._keyPhoto,"&q=").concat(e,"+city&lang=ru&image_type=photo&orientation=horizontal&category=places")).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}))}}])&&e(n.prototype,o),t}();function c(t,e){var n=document.createElement("script");n.onload=function(){ymaps.ready((function(){return a(t,e)}))},n.id="ymaps",n.src="https://api-maps.yandex.ru/2.1/?apikey=8d35dcd4-01c9-4da3-ac23-1daa50fa2b8c&lang=ru_RU",document.head.append(n)}function a(t,e){n=new ymaps.Map("map",{center:[t,e],zoom:8,controls:[]});var o=new ymaps.GeoObject({geometry:{type:"Point",coordinates:[t,e]},properties:{}},{preset:"islands#darkOrangeDotIcon"});n.geoObjects.add(o)}function r(){n.destroy()}var i={photoTown:document.querySelector(".container-pic"),mainCity:document.querySelector(".city"),temperature:document.querySelector(".city-tem"),cityName:document.querySelector(".city-name"),weatherDesc:document.querySelector(".city-descrip-weather"),weatherIcon:document.querySelector(".city-icon-weather"),cityDate:document.querySelector(".city-date"),addInfo:document.querySelector(".add-info"),searchForm:document.querySelector(".add-info-form"),temFeelsLike:document.querySelector(".add-info-data_type_feels"),wind:document.querySelector(".add-info-data_type_wind"),humidity:document.querySelector(".add-info-data_type_humidity"),userCity:document.querySelector(".add-info-list-el_type_main"),precipitation:document.querySelector(".add-info-data_type_precipitation"),forDate:{days:["ВС","ПН","ВТ","СР","ЧТ","ПТ","СБ"],months:["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"]}};function u(t){i.cityName.textContent=t.name,i.temperature.innerHTML=Math.round(t.main.temp)+"&deg;",i.weatherDesc.textContent=t.weather[0].description,i.weatherIcon.src="https://openweathermap.org/img/wn/".concat(t.weather[0].icon,"@2x.png"),i.cityDate.textContent=function(t){var e=new Date(Date.now()+1e3*t.timezone);function n(t){return String(t).length<2?"0".concat(t):t}return"".concat(n(e.getUTCHours()),":").concat(n(e.getUTCMinutes()),"\n  - ").concat(i.forDate.days[e.getDay()],",\n  ").concat(e.getUTCDate(),"\n  ").concat(i.forDate.months[e.getMonth()],"\n  ").concat(e.getUTCFullYear())}(t),i.temFeelsLike.innerHTML=Math.round(t.main.feels_like)+"&deg;",i.wind.textContent="".concat(t.wind.speed," м/с"),i.humidity.textContent="".concat(t.main.humidity,"%"),i.precipitation.textContent=function(t){return t.rain||t.snow?"".concat(t.rain?t.rain["1h"]:t.snow["1h"]," мм"):"0 мм"}(t)}function s(t){i.userCity.textContent=t.name}function h(t){i.photoTown.src=t.hits[0].largeImageURL}function d(t){var e=t.weather[0].main;y.getPhoto(t).then((function(n){0!==n.total?h(n):y.getPhotoOnlyCity(t).then((function(t){h(t)})).catch((function(){y.getOtherPhoto(e).then((function(t){h(t)}))}))})).catch((function(t){console.log(t)}))}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.cityName.textContent;y.getAnotherWeather(t).then((function(t){i.cityName.textContent!==t.name&&(d(t),r(),a(t.coord.lat,t.coord.lon)),u(t)})).catch((function(t){console.log(t)}))}i.searchForm.addEventListener("submit",(function(t){t.preventDefault(),l(document.querySelector(".add-info-input").value)})),i.addInfo.addEventListener("click",(function(t){t.target.classList.contains("add-info-list-el")&&l(t.target.textContent)}));var y=new o;navigator.geolocation.getCurrentPosition((function(t){c(t.coords.latitude,t.coords.longitude),y.getWeather(t.coords.latitude,t.coords.longitude).then((function(t){d(t),u(t),s(t)})).catch((function(t){console.log(t)}))}),(function(t){!function(t){t.code==t.PERMISSION_DENIED&&y.getLocation().then((function(t){return c(t.latitude,t.longitude),y.getWeather(t.latitude,t.longitude)})).then((function(t){d(t),u(t),s(t)})).catch((function(t){console.log(t)}))}(t)})),setInterval(l,3e4)}();